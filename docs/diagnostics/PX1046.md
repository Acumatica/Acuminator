# PX1046
This document describes the PX1046 diagnostic.

## Summary

| Code   | Short Description                                                | Type  | Code Fix    | 
| ------ | ---------------------------------------------------------------- | ----- | ----------- | 
| PX1046 | Long-running operations cannot be started within event handlers. | Error | Unavailable |

## Diagnostic Description
Long-running operations cannot be started within event handlers.

To fix the issue, you remove the invocation of the long-running operation and rework the related business logic. You can consider to configure business events related to data changes or monitored on a schedule in Acumatica ERP and perform the long-running operation once a notification about one of these events is received from Acumatica ERP. For detais about business events, see [Business Events Related to Data Changes](https://help.acumatica.com/Help?ScreenId=ShowWiki&pageid=83582d78-a752-4175-af4f-3cec6150aca0), [Business Events Monitored on a Schedule](https://help.acumatica.com/Help?ScreenId=ShowWiki&pageid=85c42962-1673-41f7-a895-5ec94b1467ca), and [Subscribers of Business Events](https://help.acumatica.com/Help?ScreenId=ShowWiki&pageid=6d9e5b08-164d-4eb8-82a6-a41136a3b8cf).

## Example of Incorrect Code

```C#
public class BinExtension : PXGraphExtension<INSiteMaint>
{
    public void INLocation_RowPersisted(PXCache sender, PXRowPersistedEventArgs e)
    {
        if (e.TranStatus != PXTranStatus.Completed) return;

        try
        {
            PXLongOperation.StartOperation(this, delegate () // The PX1046 error is displayed for this line.
            {
                //export records
            });
        }
        catch (Exception ex)
        {
            PXTrace.WriteError($"INLocation_RowPersisted - Failed. {ex}");
        }
    }
}
```

## Related Articles

 - [Asynchronous Execution](https://help.acumatica.com/Help?ScreenId=ShowWiki&pageid=3e8c46fa-54a8-4f9c-9353-aa559c346215)
 - [PXLongOperation Class](https://help.acumatica.com/Help?ScreenId=ShowWiki&pageid=80f43327-6672-79c8-6f6c-051330483112)
 - [Business Events Related to Data Changes](https://help.acumatica.com/Help?ScreenId=ShowWiki&pageid=83582d78-a752-4175-af4f-3cec6150aca0)
 - [Business Events Monitored on a Schedule](https://help.acumatica.com/Help?ScreenId=ShowWiki&pageid=85c42962-1673-41f7-a895-5ec94b1467ca)
 - [Subscribers of Business Events](https://help.acumatica.com/Help?ScreenId=ShowWiki&pageid=6d9e5b08-164d-4eb8-82a6-a41136a3b8cf)